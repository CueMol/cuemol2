include_directories(
  ${CMAKE_SOURCE_DIR}/src
  ${CMAKE_CURRENT_SOURCE_DIR}
  ${CMAKE_BINARY_DIR}/src
  ${Boost_INCLUDE_DIRS}
  )

# Normal C++ source files
SET(XTAL_SRCS
xtal.cpp
CCP4InStream.cpp
CCP4MapReader.cpp
XplorMapReader.cpp
MTZ2MapReader.cpp
DensityMap.cpp
MapMeshRenderer.cpp
MapSurfRenderer.cpp
MapRenderer.cpp
QdfDenMapReader.cpp
QdfDenMapWriter.cpp
BrixMapReader.cpp
  )

##########
# CueMol interface definitions for MCWRAPGEN

SET(XTAL_MCWG_QIFS
DensityMap.qif
MapMeshRenderer.qif
MapSurfRenderer.qif
MapRenderer.qif
MTZ2MapReader.qif
CCP4MapReader.qif
BrixMapReader.qif
  )

# module loader generated by MCWG
SET(XTAL_MODLDR_SRC xtal.moddef)

MCWRAPGEN_CLASS(XTAL_SRCS ${XTAL_MCWG_QIFS})
MCWRAPGEN_MODULE(XTAL_SRCS ${XTAL_MODLDR_SRC} ${XTAL_MCWG_QIFS})

if (WIN32)
  add_definitions(-DXTAL_EXPORTS=1)
endif()

add_library(xtal SHARED ${XTAL_SRCS})
target_link_libraries(xtal PRIVATE qlib gfx qsys molstr symm surface)

add_custom_target(xtal_generate_headers DEPENDS ${MCWG_HEADERS})
add_dependencies(xtal xtal_generate_headers)

install(TARGETS xtal
  RUNTIME DESTINATION ${CMAKE_INSTALL_BINDIR}
  LIBRARY DESTINATION ${CMAKE_INSTALL_LIBDIR}
  )
